# Production EdgeLake Operator deployment with PostgreSQL
# Full configuration for production environments
apiVersion: edgelake.trv.io/v1alpha1
kind: EdgeLakeOperator
metadata:
  name: edgelake-operator-prod
  namespace: edgelake
spec:
  metadata:
    namespace: edgelake
    hostname: edgelake-operator-prod
    app_name: edgelake-operator-prod
    service_name: edgelake-operator-prod-service
    configmap_name: edgelake-operator-prod-configmap
    service_type: LoadBalancer

  image:
    repository: anylogco/edgelake-network
    tag: "1.3.2500"
    pull_policy: Always

  persistence:
    enabled: true
    storageClassName: "standard"
    accessMode: ReadWriteOnce
    anylog:
      size: 10Gi
    blockchain:
      size: 2Gi
    data:
      size: 50Gi
    scripts:
      size: 2Gi

  resources:
    limits:
      cpu: "4000m"
      memory: "8Gi"
    requests:
      cpu: "1000m"
      memory: "2Gi"

  node_configs:
    general:
      NODE_TYPE: operator
      NODE_NAME: edgelake-operator-prod
      COMPANY_NAME: "Production Corp"
      DISABLE_CLI: true
      REMOTE_CLI: true

    geolocation:
      COUNTRY: "US"
      STATE: "California"
      CITY: "San Francisco"

    networking:
      OVERLAY_IP: ""  # Set to your VPN/Tailscale IP if using overlay network
      ANYLOG_SERVER_PORT: 32148
      ANYLOG_REST_PORT: 32149
      ANYLOG_BROKER_PORT: "32150"
      TCP_THREADS: 8
      REST_THREADS: 8

    database:
      DB_TYPE: psql
      DB_USER: edgelake
      DB_PASSWD: your-secure-password
      DB_IP: postgres-service.edgelake.svc.cluster.local
      DB_PORT: 5432
      AUTOCOMMIT: true
      SYSTEM_QUERY: true

    blockchain:
      LEDGER_CONN: "master-node-ip:32048"
      SYNC_TIME: "30 second"
      BLOCKCHAIN_SOURCE: master
      BLOCKCHAIN_DESTINATION: file

    operator:
      CLUSTER_NAME: production-cluster
      DEFAULT_DBMS: production_data
      ENABLE_HA: true
      OPERATOR_THREADS: 6
      ENABLE_PARTITIONS: true
      TABLE_NAME: "*"
      PARTITION_COLUMN: insert_timestamp
      PARTITION_INTERVAL: "7 days"
      PARTITION_KEEP: 4
      PARTITION_SYNC: "1 day"

    monitoring:
      MONITOR_NODES: true
      STORE_MONITORING: true

    advanced:
      COMPRESS_FILE: true
      QUERY_POOL: 8
      THRESHOLD_TIME: "30 seconds"
      THRESHOLD_VOLUME: "500KB"
